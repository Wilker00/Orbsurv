:root{
      --bg:#FFFFFF; --card-bg:#F9FAFB; --ink:#111827; --mute:#6B7280; --line:#E5E7EB;
      --accent-gradient:linear-gradient(135deg,#0d6efd 0%,#0dcaf0 100%); --accent-color:#0d6efd;
      --shadow-sm:0 1px 2px rgba(0,0,0,.05);
      --shadow-md:0 4px 6px -1px rgba(0,0,0,.1),0 2px 4px -1px rgba(0,0,0,.06);
      --shadow-lg:0 10px 15px -3px rgba(0,0,0,.1),0 4px 6px -2px rgba(0,0,0,.05);
      --hot:#ff5d73; --warn:#ffb84d; --ok:#34d399;
      --beam-alpha:0.10;
      --vignette: radial-gradient(120% 100% at 50% 50%, rgba(0,0,0,0) 40%, rgba(0,0,0,.10) 100%);
      --focus:#2563eb;
      --glass-bg-light: rgba(255,255,255,0.10);
      --glass-bg-dark: rgba(34,34,34,0.18);
      --glass-brd: rgba(255,255,255,0.35);
    }
    body.dark-mode{
      --bg:#222222; --card-bg:#2b2b2b; --ink:#f0f0f0; --mute:#bbbbbb; --line:#3b3b3b;
      --accent-gradient:linear-gradient(135deg,#ffffff 0%,#e5e7eb 100%); --accent-color:#ffffff;
      --shadow-sm:0 1px 2px rgba(0,0,0,.2);
      --shadow-md:0 4px 6px -1px rgba(0,0,0,.3),0 2px 4px -1px rgba(0,0,0,.2);
      --shadow-lg:0 10px 15px -3px rgba(0,0,0,.35),0 4px 6px -2px rgba(0,0,0,.25);
      --beam-alpha:0.14;
      --vignette: radial-gradient(120% 100% at 50% 50%, rgba(0,0,0,0) 35%, rgba(0,0,0,.22) 100%);
    }

    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:var(--bg);color:var(--ink);line-height:1.6;transition:background-color .3s,color .3s}
    a{color:var(--accent-color);text-decoration:none}

    header{position:sticky;top:0;background-color:rgba(255,255,255,.9);backdrop-filter:blur(10px);z-index:100;padding:16px 0;border-bottom:1px solid var(--line);transition:.3s}
    body.dark-mode header{background-color:rgba(34,34,34,.85)}
    .wrap{max-width:1200px;margin:0 auto;padding:0 24px}
    .nav-container{display:flex;justify-content:space-between;align-items:center}
    .logo{font-family:Sora,Inter,sans-serif;font-weight:700;font-size:1.5rem}
    .nav-right{display:flex;align-items:center;gap:24px}
    .nav-links{display:flex;background:var(--card-bg);padding:8px;border-radius:999px;border:1px solid var(--line)}
    .nav-links a{padding:12px 20px;color:var(--mute);border-radius:999px}
    .nav-links a:hover,.nav-links a:focus-visible{background:var(--bg);color:var(--ink);box-shadow:var(--shadow-sm);outline:none}

    .theme-switch{display:inline-block;height:24px;position:relative;width:50px}
    .theme-switch input{display:none}
    .slider{background-color:var(--line);bottom:0;cursor:pointer;left:0;position:absolute;right:0;top:0;transition:.4s;border-radius:34px}
    .slider:before{background:var(--bg);border:1px solid var(--line);bottom:3px;content:"";height:18px;left:3px;position:absolute;transition:.4s;width:18px;border-radius:50%}
    input:checked + .slider{background-color:var(--line)}
    input:checked + .slider:before{transform:translateX(26px)}
    .slider .sun,.slider .moon{position:absolute;top:50%;transform:translateY(-50%);pointer-events:none}
    .slider .sun{left:6px;opacity:1;transition:.3s}
    .slider .moon{right:6px;opacity:0;transition:.3s}
    input:checked + .slider .sun{opacity:0}
    input:checked + .slider .moon{opacity:1}

    .section{padding:48px 0}
    .grid{display:grid;gap:16px}
    .card{background:var(--card-bg);border:1px solid var(--line);border-radius:24px;box-shadow:var(--shadow-md)}
    .pad{padding:24px}

    h1{font-family:Sora,Inter,sans-serif;font-size:clamp(2rem,4vw,2.5rem);line-height:1.15;margin:8px 0;background:var(--accent-gradient);-webkit-background-clip:text;background-clip:text;color:transparent}
    .lead{color:var(--mute);font-size:1.075rem}

    .btnbar{display:flex;gap:8px;align-items:center;background:var(--card-bg);border:1px solid var(--line);padding:8px;border-radius:999px;box-shadow:var(--shadow-sm)}
    .btn{border:1px solid transparent;background:transparent;color:var(--mute);padding:10px 14px;border-radius:999px;font:600 14px Inter,system-ui;cursor:pointer;transition:.18s}
    .btn:hover{background:var(--bg);color:var(--ink);box-shadow:var(--shadow-sm);transform:translateY(-1px)}
    .btn:focus-visible{outline:2px solid var(--focus);outline-offset:1px}
    .btn.active,[aria-pressed="true"]{background:var(--ink);color:var(--bg)}
    .btn.badge{font-weight:600}
    .row{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
    .mini{font:12px/1.2 'Roboto Mono',monospace;color:var(--mute)}

    .railStage{position:relative;height:360px;overflow:hidden;border-radius:24px}
    .railStage::after{content:"";position:absolute;inset:0;pointer-events:none;background:var(--vignette)}
    .rail{position:absolute;left:24px;right:24px;top:50%;height:10px;transform:translateY(-50%);
      background:linear-gradient(90deg,rgba(0,0,0,.06),rgba(0,0,0,.12));border:1px solid var(--line);border-radius:999px;box-shadow:inset 0 0 0 1px rgba(255,255,255,.03)}
    .tick{position:absolute;top:-7px;width:2px;height:20px;background:rgba(0,0,0,.15)}
    body.dark-mode .tick{background:rgba(255,255,255,.12)}

    .car{position:absolute;top:50%;width:94px;height:56px;border-radius:18px;transform:translate(-50%,-50%);background:var(--bg);border:1px solid var(--line);box-shadow:var(--shadow-lg)}
    .eye{position:absolute;left:10px;right:10px;top:-18px;height:18px;border-radius:14px;background:var(--card-bg);border:1px solid var(--line);box-shadow:var(--shadow-sm)}
    .beam{position:absolute;left:50%;transform:translateX(-50%);bottom:56px;width:0;height:0;border-left:220px solid transparent;border-right:220px solid transparent;border-top:220px solid rgba(13,110,253,var(--beam-alpha));filter:blur(.25px);transition:border-top-color .2s}
    .beamGlow{position:absolute;left:50%;transform:translateX(-50%);bottom:48px;width:320px;height:140px;filter:blur(14px);opacity:.35;pointer-events:none;background:radial-gradient(60% 100% at 50% 100%, rgba(13,110,253,.45), rgba(13,110,253,0) 70%)}
    body.dark-mode .beamGlow{opacity:.55}
    .floorWash{position:absolute;top:50%;transform:translate(-50%,-50%);left:0;width:380px;height:130px;border-radius:50%;pointer-events:none;filter:blur(24px);opacity:.55;background:radial-gradient(60% 55% at 50% 50%, rgba(13,110,253,.25), rgba(13,110,253,0) 75%)}

    .hud{position:absolute;left:12px;right:12px;bottom:12px;display:flex;gap:12px;flex-wrap:wrap;justify-content:space-between;z-index:6}

    /* Reusable glass panel */
    .glass{
      border-radius:16px;
      background: var(--glass-bg-light);
      border:1px solid var(--glass-brd);
      backdrop-filter: blur(14px) saturate(140%);
      -webkit-backdrop-filter: blur(14px) saturate(140%);
      box-shadow: 0 10px 25px rgba(0,0,0,.20), inset 0 1px 0 rgba(255,255,255,.25);
      overflow:hidden;
    }
    body.dark-mode .glass{ background: var(--glass-bg-dark); border-color: rgba(255,255,255,0.20); box-shadow: 0 12px 28px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.14); }

    /* FEED */
    .feed{ position:absolute; right:12px; top:12px; width:260px; z-index:3; }
    .feedHead{ display:flex; align-items:center; justify-content:space-between; padding:8px 10px; border-bottom:1px solid rgba(255,255,255,.35); background: linear-gradient(180deg, rgba(255,255,255,.16), rgba(255,255,255,.06)); }
    body.dark-mode .feedHead{ border-bottom-color: rgba(255,255,255,.18); background: linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.04)); }
    .feedTitle{font:600 12px Inter,system-ui;color:var(--mute)}
    canvas#feedCanvas{display:block;width:100%;height:160px;cursor:crosshair}
    .feedNoise{position:absolute;inset:0;pointer-events:none;background:repeating-linear-gradient(transparent 0 1px, rgba(0,0,0,.02) 1px 2px), repeating-linear-gradient(90deg, transparent 0 2px, rgba(0,0,0,.02) 2px 3px);mix-blend-mode:multiply;opacity:.22}
    .feedHUD{position:absolute;right:16px;bottom:8px;font:600 10px 'Roboto Mono',monospace;background:rgba(0,0,0,.42);color:#fff;padding:4px 6px;border-radius:8px}

    /* OPS */
    .ops{ position:fixed; left:12px; top:76px; width:320px; max-height:70vh; overflow:auto; z-index:30; padding:10px; }
    .ops h3{margin:6px 0 8px; font:700 13px Sora,Inter,sans-serif; letter-spacing:.2px}
    .ops .kv{display:grid; grid-template-columns:110px 1fr; gap:6px; font:600 11px 'Roboto Mono',monospace; color:var(--mute)}
    .ops .kv b{color:var(--ink); font-weight:700}
    .ops .bar{height:8px; background:linear-gradient(90deg,#e5e7eb,#d1d5db); border:1px solid var(--line); border-radius:999px; overflow:hidden}
    .ops .bar>span{display:block; height:100%; background:var(--accent-color)}
    .ops .cand{border:1px solid var(--line); border-radius:10px; padding:8px; margin:6px 0; background:var(--card-bg)}
    .ops .cand .meta{font:600 10px 'Roboto Mono',monospace; color:var(--mute)}
    .ops .row{display:flex; gap:6px; align-items:center}
    .ops .range{width:140px}
    .ops .hint{font:11px/1.3 Inter,system-ui; color:var(--mute); margin-top:4px}
    .opsHide{display:none}

    /* Range */
    .range{appearance:none;height:8px;border-radius:10px;background:linear-gradient(#eee,#ddd);border:1px solid var(--line);box-shadow:inset 0 1px 2px rgba(0,0,0,.15);width:220px}
    .range::-webkit-slider-thumb{appearance:none;width:22px;height:22px;border-radius:50%;background:#fff;border:1px solid rgba(0,0,0,.2);box-shadow:0 1px 2px rgba(0,0,0,.2)}
    .range::-moz-range-thumb{width:22px;height:22px;border-radius:50%;background:#fff;border:1px solid rgba(0,0,0,.2)}

    footer{border-top:1px solid var(--line);padding:24px 0;color:var(--mute);text-align:center}

    @media (max-width:900px){
      .railStage{ padding-bottom:260px; }
      .feed{ top:auto; bottom:12px; width: min(340px, 90%); }
      .hud{ justify-content:center; }
      .ops{ width:min(92%, 420px); top:auto; bottom:12px; left:12px; right:12px; }
    }

    @keyframes beam-flicker{0%,100%{opacity:.95}50%{opacity:.82}}
    @keyframes dot-pop{0%{transform:scale(.6);opacity:0}60%{transform:scale(1.1);opacity:1}100%{transform:scale(1);opacity:1}}

    dialog{border:none;border-radius:16px;max-width:900px;width:92%;padding:0;box-shadow:var(--shadow-lg);background:var(--card-bg);color:var(--ink)}
    dialog::backdrop{background:rgba(0,0,0,.4)}
    .modalHead{display:flex;justify-content:space-between;align-items:center;padding:14px 16px;border-bottom:1px solid var(--line)}
    .modalBody{max-height:70vh;overflow:auto;padding:10px 16px 16px}
    .logRow{display:grid;grid-template-columns:88px 1fr;gap:12px;align-items:start;padding:10px;border-bottom:1px dashed var(--line)}
    .pill{display:inline-block;padding:2px 8px;border-radius:999px;background:var(--bg);border:1px solid var(--line);font:600 11px Inter,system-ui;color:var(--mute)}
    .thumbGrid{display:grid;grid-template-columns:repeat(auto-fill, minmax(120px,1fr));gap:10px;margin-top:10px}
    .thumb{border:1px solid var(--line);border-radius:10px;overflow:hidden;background:#000}
    .thumb img{display:block;width:100%;height:auto}
    .thumb a{display:block;padding:6px 8px;font:600 10px 'Roboto Mono',monospace;color:var(--ink);text-decoration:none;border-top:1px solid var(--line);background:var(--card-bg)}

    /* Error overlay */
    .errOverlay{ position:fixed; inset:auto 12px 12px auto; max-width:420px; padding:10px 12px; border-radius:12px; background:#fee2e2; color:#991b1b; border:1px solid #fecaca; box-shadow:var(--shadow-lg); font:600 12px/1.4 'Roboto Mono',monospace; z-index:50; }
    .errOverlay.hidden{ display:none; }
