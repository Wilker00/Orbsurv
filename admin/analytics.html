
<!DOCTYPE html>
<html lang="en" data-require-dev>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noindex, nofollow">
  <title>Analytics Dashboard - Orbsurv</title>
  <link rel="icon" type="image/x-icon" href="../Image/Group 213.png">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Sora:wght@600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="../css/global.css">
  <link rel="stylesheet" href="../css/shared-vars.css">
  <link rel="stylesheet" href="../css/privacy.css">
  <link rel="stylesheet" href="../css/index.css">
  <link rel="stylesheet" href="../css/app.css">
</head>
<body class="admin-body">
  <header class="site-header" data-include="../_header.html"></header>

  <main class="admin-main">
    <section class="admin-hero hero-gradient">
      <div class="wrap">
        <p class="hero-eyebrow">Developer Console</p>
        <h1>Analytics overview</h1>
        <p class="hero-copy">Track waitlist growth, pilot interest, and engagement across Orbsurv surfaces. This page will plug into analytics API endpoints before launch.</p>
      </div>
    </section>

    <section class="wrap admin-grid">
      <article class="card" id="metrics-card">
        <h2>Key metrics</h2>
        <ul id="metrics-list" style="list-style:none;padding-left:0;display:grid;gap:8px;">
          <li>Loading metrics…</li>
        </ul>
      </article>

      <article class="card">
        <h2>Next steps</h2>
        <ol style="padding-left:1.1rem;display:grid;gap:8px;">
          <li>Connect analytics API to <code>/api/v1/admin/summary</code></li>
          <li>Overlay pilot performance metrics from rail sensors</li>
          <li>Ship CSV export for founders and investors</li>
        </ol>
      </article>
    </section>
  </main>

  <footer class="site-footer" data-include="../_footer.html"></footer>

  <script src="../js/global.js"></script>
  <script src="../js/forms.js"></script>
  <script src="../js/auth-guard.js"></script>
  <script src="../js/admin-api.js"></script>
  <script src="../js/index.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', async () => {
      const list = document.getElementById('metrics-list');
      if (!list) return;

      // Ensure DEV role
      if (window.AuthGuard) {
        const hasDev = await window.AuthGuard.ensureDevRole();
        if (!hasDev) return;
      }

      try {
        const summary = await window.AdminAPI.getSummary();
        const items = [];
        
        if (summary) {
          items.push({ label: 'Total Users', value: summary.total_users || 0 });
          items.push({ label: 'Waitlist Entries', value: summary.total_waitlist || 0 });
          items.push({ label: 'Contact Requests', value: summary.total_contacts || 0 });
          items.push({ label: 'Pilot Requests', value: summary.total_pilot_requests || 0 });
          items.push({ label: 'Investor Interest', value: summary.total_investor_interest || 0 });
        }

        list.innerHTML = '';
        if (!items.length) {
          list.innerHTML = '<li>No metrics available.</li>';
        } else {
          items.forEach((m) => {
            const li = document.createElement('li');
            li.innerHTML = `<strong>${m.label}</strong> — ${m.value}`;
            list.appendChild(li);
          });
        }
      } catch (error) {
        console.error('Unable to load analytics summary', error);
        window.AuthGuard?.handleAuthError(error);
        list.innerHTML = '<li>Analytics unavailable. Please check your connection.</li>';
      }
    });
  </script>
</body>
</html>







